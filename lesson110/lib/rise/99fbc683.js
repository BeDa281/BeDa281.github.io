"use strict";(self.wpRiseJsonp=self.wpRiseJsonp||[]).push([["recorder"],{54769:function(t,e,n){n.r(e),n.d(e,{startRecording:function(){return Bt}});var o=n(46774),r=n(84849),s=n(43479),i=n(15866),a=n(63781),c=n(48967),u=n(19250),l=n(7907),d=n(34533);const f=new WeakMap;function p(t){return f.has(t)}function h(t){return f.get(t)}function m(t,e){const n=t.tagName,o=t.value;if((0,d.gR)(t,e)){const e=t.type;if("INPUT"===n&&("button"===e||"submit"===e||"reset"===e))return o;if(!o||"OPTION"===n)return;return d.k6}return"OPTION"===n||"SELECT"===n?t.value:"INPUT"===n||"TEXTAREA"===n?o:void 0}const g=/url\((?:(')([^']*)'|(")([^"]*)"|([^)]*))\)/gm,y=/^[A-Za-z]+:|^\/\//,v=/^data:.*,/i;function w(t,e){return t.replace(g,((t,n,o,r,s,i)=>{const a=o||s||i;if(!e||!a||y.test(a)||v.test(a))return t;const c=n||r||"";return`url(${c}${function(t,e){try{return(0,l.Q2)(t,e).href}catch(e){return t}}(a,e)}${c})`}))}const E=/[^a-z1-6-_]/;function S(t){const e=t.toLowerCase().trim();return E.test(e)?"div":e}function N(t,e){return`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='${t}' height='${e}' style='background-color:silver'%3E%3C/svg%3E`}const x=2,T=3,b=4,I=6,R=7,C=8,O=9,L=0,_=1,M=2,D=3,P=4,k=11,z=0,A=1,V=2,$=3,H=4,X=5,F=6,W=7,B=8,G=0,U=1,Y=2,J=3,Z=4,j=5,K=6,q=7,Q=9,tt=0,et=1;function nt(t){if(void 0!==t&&0!==t.length)return t.map((t=>{const e=t.cssRules||t.rules;return{cssRules:Array.from(e,(t=>t.cssText)),disabled:t.disabled||void 0,media:t.media.length>0?Array.from(t.media):void 0}}))}var ot=n(39789);function rt(t,e,n,o){if(e===d.zx.HIDDEN)return null;const r=t.getAttribute(n);if(e===d.zx.MASK&&n!==d.$n&&!d.YO.includes(n)&&n!==o.actionNameAttribute){const e=t.tagName;switch(n){case"title":case"alt":case"placeholder":return d.k6}if("IMG"===e&&("src"===n||"srcset"===n)){const e=t;if(e.naturalWidth>0)return N(e.naturalWidth,e.naturalHeight);const{width:n,height:o}=t.getBoundingClientRect();return n>0||o>0?N(n,o):d.Xn}if("SOURCE"===e&&("src"===n||"srcset"===n))return d.Xn;if("A"===e&&"href"===n)return d.k6;if(r&&n.startsWith("data-"))return d.k6;if("IFRAME"===e&&"srcdoc"===n)return d.k6}return r&&"string"==typeof r&&(0,d.p2)(r)?(0,d.lk)(r):r}function st(t){if(!t)return null;let e;try{e=t.rules||t.cssRules}catch(t){}if(!e)return null;return w(Array.from(e,(0,ot.G6)()?it:at).join(""),t.href)}function it(t){if(function(t){return"selectorText"in t}(t)&&t.selectorText.includes(":")){const e=/(\[[\w-]+[^\\])(:[^\]]+\])/g;return t.cssText.replace(e,"$1\\$2")}return at(t)}function at(t){return function(t){return"styleSheet"in t}(t)&&st(t.styleSheet)||t.cssText}function ct(t,e){const n=function(t,e){switch(t.nodeType){case t.DOCUMENT_NODE:return function(t,e){return{type:L,childNodes:lt(t,e),adoptedStyleSheets:nt(t.adoptedStyleSheets)}}(t,e);case t.DOCUMENT_FRAGMENT_NODE:return function(t,e){const n=(0,d.VO)(t);n&&e.serializationContext.shadowRootsController.addShadowRoot(t);return{type:k,childNodes:lt(t,e),isShadowRoot:n,adoptedStyleSheets:n?nt(t.adoptedStyleSheets):void 0}}(t,e);case t.DOCUMENT_TYPE_NODE:return{type:_,name:(n=t).name,publicId:n.publicId,systemId:n.systemId};case t.ELEMENT_NODE:return function(t,e){const n=S(t.tagName),o=(s=t,"svg"===s.tagName||s instanceof SVGElement||void 0),r=(0,d.Ch)((0,d.SZ)(t),e.parentNodePrivacyLevel);var s;if(r===d.zx.HIDDEN){const{width:e,height:r}=t.getBoundingClientRect();return{type:M,tagName:n,attributes:{rr_width:`${e}px`,rr_height:`${r}px`,[d.$n]:d.nw},childNodes:[],isSVG:o}}if(r===d.zx.IGNORE)return;const i=function(t,e,n){if(e===d.zx.HIDDEN)return{};const o={},r=S(t.tagName),s=t.ownerDocument;for(let r=0;r<t.attributes.length;r+=1){const s=t.attributes.item(r).name,i=rt(t,e,s,n.configuration);null!==i&&(o[s]=i)}if(t.value&&("textarea"===r||"select"===r||"option"===r||"input"===r)){const n=m(t,e);void 0!==n&&(o.value=n)}if("option"===r&&e===d.zx.ALLOW){const e=t;e.selected&&(o.selected=e.selected)}if("link"===r){const e=Array.from(s.styleSheets).find((e=>e.href===t.href)),n=st(e);n&&e&&(o._cssText=n)}if("style"===r&&t.sheet){const e=st(t.sheet);e&&(o._cssText=e)}const i=t;if("input"!==r||"radio"!==i.type&&"checkbox"!==i.type||(e===d.zx.ALLOW?o.checked=!!i.checked:(0,d.gR)(i,e)&&delete o.checked),"audio"===r||"video"===r){const e=t;o.rr_mediaState=e.paused?"paused":"played"}let a,c;const u=n.serializationContext;switch(u.status){case 0:a=Math.round(t.scrollTop),c=Math.round(t.scrollLeft),(a||c)&&u.elementsScrollPositions.set(t,{scrollTop:a,scrollLeft:c});break;case 1:u.elementsScrollPositions.has(t)&&({scrollTop:a,scrollLeft:c}=u.elementsScrollPositions.get(t))}return c&&(o.rr_scrollLeft=c),a&&(o.rr_scrollTop=a),o}(t,r,e);let a=[];if((0,d.Sn)(t)&&"style"!==n){let o;o=e.parentNodePrivacyLevel===r&&e.ignoreWhiteSpace===("head"===n)?e:{...e,parentNodePrivacyLevel:r,ignoreWhiteSpace:"head"===n},a=lt(t,o)}return{type:M,tagName:n,attributes:i,childNodes:a,isSVG:o}}(t,e);case t.TEXT_NODE:return function(t,e){const n=(0,d.FB)(t,e.ignoreWhiteSpace||!1,e.parentNodePrivacyLevel);if(void 0===n)return;return{type:D,textContent:n}}(t,e);case t.CDATA_SECTION_NODE:return{type:P,textContent:""}}var n}(t,e);if(!n)return null;const o=h(t)||ut++,r=n;return r.id=o,function(t,e){f.set(t,e)}(t,o),e.serializedNodeIds&&e.serializedNodeIds.add(o),r}let ut=1;function lt(t,e){const n=[];return(0,d.Uo)(t,(t=>{const o=ct(t,e);o&&n.push(o)})),n}function dt(t,e,n){return ct(t,{serializationContext:n,parentNodePrivacyLevel:e.defaultPrivacyLevel,configuration:e})}function ft(t){return Boolean(t.changedTouches)}function pt(t){return!0===t.composed&&(0,d.aT)(t.target)?t.composedPath()[0]:t.target}const ht=(t,e)=>{const n=window.visualViewport,o={layoutViewportX:t,layoutViewportY:e,visualViewportX:t,visualViewportY:e};return n?(!function(t){return Math.abs(t.pageTop-t.offsetTop-window.scrollY)>25||Math.abs(t.pageLeft-t.offsetLeft-window.scrollX)>25}(n)?(o.visualViewportX=Math.round(t-n.offsetLeft),o.visualViewportY=Math.round(e-n.offsetTop)):(o.layoutViewportX=Math.round(t+n.offsetLeft),o.layoutViewportY=Math.round(e+n.offsetTop)),o):o},mt=t=>({scale:t.scale,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,pageLeft:t.pageLeft,pageTop:t.pageTop,height:t.height,width:t.width});var gt=n(81729);function yt(t,e){return{data:{source:t,...e},type:T,timestamp:(0,gt.n$)()}}function vt(t,e){const{throttled:n,cancel:o}=(0,c.P)((t=>{const n=pt(t);if(p(n)){const o=wt(t);if(!o)return;const r={id:h(n),timeOffset:0,x:o.x,y:o.y};e(yt(ft(t)?F:A,{positions:[r]}))}}),50,{trailing:!1}),{stop:r}=(0,u.y)(t,document,["mousemove","touchmove"],n,{capture:!0,passive:!0});return{stop:()=>{r(),o()}}}function wt(t){let{clientX:e,clientY:n}=ft(t)?t.changedTouches[0]:t;if(window.visualViewport){const{visualViewportX:t,visualViewportY:o}=ht(e,n);e=t,n=o}if(Number.isFinite(e)&&Number.isFinite(n))return{x:e,y:n};t.isTrusted&&(0,o.eJ)("mouse/touch event without x/y")}const Et={pointerup:G,mousedown:U,click:Y,contextmenu:J,dblclick:Z,focus:j,blur:K,touchstart:q,touchend:Q};function St(t,e,n){return(0,u.y)(t,document,Object.keys(Et),(o=>{const r=pt(o);if((0,d.IE)(r,t.defaultPrivacyLevel)===d.zx.HIDDEN||!p(r))return;const s=h(r),i=Et[o.type];let a;if(i!==K&&i!==j){const t=wt(o);if(!t)return;a={id:s,type:i,x:t.x,y:t.y}}else a={id:s,type:i};const c={id:n.getIdForEvent(o),...yt(V,a)};e(c)}),{capture:!0,passive:!0})}function Nt(t,e,n,o=document){const{throttled:r,cancel:s}=(0,c.P)((o=>{const r=pt(o);if(!r||(0,d.IE)(r,t.defaultPrivacyLevel)===d.zx.HIDDEN||!p(r))return;const s=h(r),i=r===document?{scrollTop:(0,d.X_)(),scrollLeft:(0,d.$1)()}:{scrollTop:Math.round(r.scrollTop),scrollLeft:Math.round(r.scrollLeft)};n.set(r,i),e(yt($,{id:s,x:i.scrollLeft,y:i.scrollTop}))}),100),{stop:i}=(0,u.O)(t,o,"scroll",r,{capture:!0,passive:!0});return{stop:()=>{i(),s()}}}function xt(t,e){const n=(0,d.AX)(t).subscribe((t=>{e(yt(H,t))}));return{stop:()=>{n.unsubscribe()}}}function Tt(t,e){const n=window.visualViewport;if(!n)return{stop:c.Z};const{throttled:o,cancel:r}=(0,c.P)((()=>{e({data:mt(n),type:C,timestamp:(0,gt.n$)()})}),200,{trailing:!1}),{stop:s}=(0,u.y)(t,n,["resize","scroll"],o,{capture:!0,passive:!0});return{stop:()=>{s(),r()}}}function bt(t,e){return(0,u.y)(t,document,["play","pause"],(n=>{const o=pt(n);o&&(0,d.IE)(o,t.defaultPrivacyLevel)!==d.zx.HIDDEN&&p(o)&&e(yt(W,{id:h(o),type:"play"===n.type?tt:et}))}),{capture:!0,passive:!0})}var It=n(33318);function Rt(t){function e(t,e){t&&p(t.ownerNode)&&e(h(t.ownerNode))}const n=[(0,It.S)(CSSStyleSheet.prototype,"insertRule",(({target:n,parameters:[o,r]})=>{e(n,(e=>t(yt(B,{id:e,adds:[{rule:o,index:r}]}))))})),(0,It.S)(CSSStyleSheet.prototype,"deleteRule",(({target:n,parameters:[o]})=>{e(n,(e=>t(yt(B,{id:e,removes:[{index:o}]}))))}))];function o(o){n.push((0,It.S)(o.prototype,"insertRule",(({target:n,parameters:[o,r]})=>{e(n.parentStyleSheet,(e=>{const s=Ct(n);s&&(s.push(r||0),t(yt(B,{id:e,adds:[{rule:o,index:s}]})))}))})),(0,It.S)(o.prototype,"deleteRule",(({target:n,parameters:[o]})=>{e(n.parentStyleSheet,(e=>{const r=Ct(n);r&&(r.push(o),t(yt(B,{id:e,removes:[{index:r}]})))}))})))}return"undefined"!=typeof CSSGroupingRule?o(CSSGroupingRule):(o(CSSMediaRule),o(CSSSupportsRule)),{stop:()=>{n.forEach((t=>t.stop()))}}}function Ct(t){const e=[];let n=t;for(;n.parentRule;){const t=Array.from(n.parentRule.cssRules).indexOf(n);e.unshift(t),n=n.parentRule}if(!n.parentStyleSheet)return;const o=Array.from(n.parentStyleSheet.cssRules).indexOf(n);return e.unshift(o),e}function Ot(t,e){return(0,u.y)(t,window,["focus","blur"],(()=>{e({data:{has_focus:document.hasFocus()},type:I,timestamp:(0,gt.n$)()})}))}function Lt(t,e,n){const o=t.subscribe(11,(t=>{var o,r;"action"===t.rawRumEvent.type&&"click"===t.rawRumEvent.action.type&&(null===(r=null===(o=t.rawRumEvent.action.frustration)||void 0===o?void 0:o.type)||void 0===r?void 0:r.length)&&"events"in t.domainContext&&t.domainContext.events&&t.domainContext.events.length&&e({timestamp:t.rawRumEvent.date,type:O,data:{frustrationTypes:t.rawRumEvent.action.frustration.type,recordIds:t.domainContext.events.map((t=>n.getIdForEvent(t)))}})}));return{stop:()=>{o.unsubscribe()}}}function _t(t,e){const n=t.subscribe(4,(()=>{e({timestamp:(0,gt.n$)(),type:R})}));return{stop:()=>{n.unsubscribe()}}}function Mt(t,e,n=document){const o=t.defaultPrivacyLevel,r=new WeakMap,s=n!==document,{stop:i}=(0,u.y)(t,n,s?["change"]:["input","change"],(t=>{const e=pt(t);(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement)&&l(e)}),{capture:!0,passive:!0});let a;if(s)a=c.Z;else{const t=[(0,It.X)(HTMLInputElement.prototype,"value",l),(0,It.X)(HTMLInputElement.prototype,"checked",l),(0,It.X)(HTMLSelectElement.prototype,"value",l),(0,It.X)(HTMLTextAreaElement.prototype,"value",l),(0,It.X)(HTMLSelectElement.prototype,"selectedIndex",l)];a=()=>{t.forEach((t=>t.stop()))}}return{stop:()=>{a(),i()}};function l(t){const e=(0,d.IE)(t,o);if(e===d.zx.HIDDEN)return;const n=t.type;let r;if("radio"===n||"checkbox"===n){if((0,d.gR)(t,e))return;r={isChecked:t.checked}}else{const n=m(t,e);if(void 0===n)return;r={text:n}}f(t,r);const s=t.name;"radio"===n&&s&&t.checked&&document.querySelectorAll(`input[type="radio"][name="${CSS.escape(s)}"]`).forEach((e=>{e!==t&&f(e,{isChecked:!1})}))}function f(t,n){if(!p(t))return;const o=r.get(t);o&&o.text===n.text&&o.isChecked===n.isChecked||(r.set(t,n),e(yt(X,{id:h(t),...n})))}}var Dt=n(61046),Pt=n(58651);function kt(t,e,n,o){const r=(0,d.q5)();if(!r)return{stop:c.Z,flush:c.Z};const s=function(t){let e=c.Z,n=[];function o(){e(),t(n),n=[]}const{throttled:r,cancel:s}=(0,c.P)(o,16,{leading:!1});return{addMutations:t=>{0===n.length&&(e=(0,Pt.Kk)(r,{timeout:100})),n.push(...t)},flush:o,stop:()=>{e(),s()}}}((o=>{!function(t,e,n,o){const r=new Map;t.filter((t=>"childList"===t.type)).forEach((t=>{t.removedNodes.forEach((t=>{zt(t,o.removeShadowRoot)}))}));const s=t.filter((t=>t.target.isConnected&&function(t){let e=t;for(;e;){if(!p(e)&&!(0,d.VO)(e))return!1;e=(0,d.Ow)(e)}return!0}(t.target)&&(0,d.IE)(t.target,n.defaultPrivacyLevel,r)!==d.zx.HIDDEN)),{adds:i,removes:a,hasBeenSerialized:c}=function(t,e,n,o){const r=new Set,s=new Map;for(const e of t)e.addedNodes.forEach((t=>{r.add(t)})),e.removedNodes.forEach((t=>{r.has(t)||s.set(t,e.target),r.delete(t)}));const i=Array.from(r);a=i,a.sort(((t,e)=>{const n=t.compareDocumentPosition(e);return n&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:n&Node.DOCUMENT_POSITION_CONTAINS||n&Node.DOCUMENT_POSITION_FOLLOWING?1:n&Node.DOCUMENT_POSITION_PRECEDING?-1:0}));var a;const c=new Set,u=[];for(const t of i){if(f(t))continue;const r=(0,d.IE)(t.parentNode,e.defaultPrivacyLevel,o);if(r===d.zx.HIDDEN||r===d.zx.IGNORE)continue;const s=ct(t,{serializedNodeIds:c,parentNodePrivacyLevel:r,serializationContext:{status:2,shadowRootsController:n},configuration:e});if(!s)continue;const i=(0,d.Ow)(t);u.push({nextId:m(t),parentId:h(i),node:s})}const l=[];return s.forEach(((t,e)=>{p(e)&&l.push({parentId:h(t),id:h(e)})})),{adds:u,removes:l,hasBeenSerialized:f};function f(t){return p(t)&&c.has(h(t))}function m(t){let e=t.nextSibling;for(;e;){if(p(e))return h(e);e=e.nextSibling}return null}}(s.filter((t=>"childList"===t.type)),n,o,r),u=function(t,e,n){var o;const r=[],s=new Set,i=t.filter((t=>!s.has(t.target)&&(s.add(t.target),!0)));for(const t of i){if(t.target.textContent===t.oldValue)continue;const s=(0,d.IE)((0,d.Ow)(t.target),e.defaultPrivacyLevel,n);s!==d.zx.HIDDEN&&s!==d.zx.IGNORE&&r.push({id:h(t.target),value:null!==(o=(0,d.FB)(t.target,!1,s))&&void 0!==o?o:null})}return r}(s.filter((t=>"characterData"===t.type&&!c(t.target))),n,r),l=function(t,e,n){const o=[],r=new Map,s=t.filter((t=>{const e=r.get(t.target);return(!e||!e.has(t.attributeName))&&(e?e.add(t.attributeName):r.set(t.target,new Set([t.attributeName])),!0)})),i=new Map;for(const t of s){if(t.target.getAttribute(t.attributeName)===t.oldValue)continue;const r=(0,d.IE)(t.target,e.defaultPrivacyLevel,n),s=rt(t.target,r,t.attributeName,e);let a;if("value"===t.attributeName){const e=m(t.target,r);if(void 0===e)continue;a=e}else a="string"==typeof s?s:null;let c=i.get(t.target);c||(c={id:h(t.target),attributes:{}},o.push(c),i.set(t.target,c)),c.attributes[t.attributeName]=a}return o}(s.filter((t=>"attributes"===t.type&&!c(t.target))),n,r);if(!(u.length||l.length||a.length||i.length))return;e(yt(z,{adds:i,removes:a,texts:u,attributes:l}))}(o.concat(i.takeRecords()),t,e,n)})),i=new r((0,Dt.zk)(s.addMutations));return i.observe(o,{attributeOldValue:!0,attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{stop:()=>{i.disconnect(),s.stop()},flush:()=>{s.flush()}}}function zt(t,e){(0,d.aT)(t)&&e(t.shadowRoot),(0,d.Uo)(t,(t=>zt(t,e)))}function At(t){const{emit:e,configuration:n,lifeCycle:o}=t;if(!e)throw new Error("emit function is required");const r=n=>{e(n),(0,i.j)("record",{record:n});const o=t.viewHistory.findView();a.xK(o.id)},s=function(){const t=new WeakMap;return{set(e,n){(e!==document||document.scrollingElement)&&t.set(e===document?document.scrollingElement:e,n)},get:e=>t.get(e),has:e=>t.has(e)}}(),c=((t,e,n)=>{const o=new Map,r={addShadowRoot:s=>{if(o.has(s))return;const i=kt(e,t,r,s),a=Mt(t,e,s),c=Nt(t,e,n,s);o.set(s,{flush:()=>i.flush(),stop:()=>{i.stop(),a.stop(),c.stop()}})},removeShadowRoot:t=>{const e=o.get(t);e&&(e.stop(),o.delete(t))},stop:()=>{o.forEach((({stop:t})=>t()))},flush:()=>{o.forEach((({flush:t})=>t()))}};return r})(n,r,s),{stop:u}=function(t,e,n,o,r,s){const i=(n=(0,gt.n$)(),r={status:0,elementsScrollPositions:t,shadowRootsController:e})=>{const{width:s,height:i}=(0,d.PA)(),a=[{data:{height:i,href:window.location.href,width:s},type:b,timestamp:n},{data:{has_focus:document.hasFocus()},type:I,timestamp:n},{data:{node:dt(document,o,r),initialOffset:{left:(0,d.$1)(),top:(0,d.X_)()}},type:x,timestamp:n}];return window.visualViewport&&a.push({data:mt(window.visualViewport),type:C,timestamp:n}),a};s(i());const{unsubscribe:a}=n.subscribe(2,(n=>{r(),s(i(n.startClocks.timeStamp,{shadowRootsController:e,status:1,elementsScrollPositions:t}))}));return{stop:a}}(s,c,o,n,l,(t=>t.forEach((t=>r(t)))));function l(){c.flush(),p.flush()}const f=function(){const t=new WeakMap;let e=1;return{getIdForEvent:n=>(t.has(n)||t.set(n,e++),t.get(n))}}(),p=kt(r,n,c,document),h=[p,vt(n,r),St(n,r,f),Nt(n,r,s,document),xt(n,r),Mt(n,r),bt(n,r),Rt(r),Ot(n,r),Tt(n,r),Lt(o,r,f),_t(o,(t=>{l(),r(t)}))];return{stop:()=>{c.stop(),h.forEach((t=>t.stop())),u()},flushMutations:l,shadowRootsController:c}}var Vt=n(14631),$t=n(36401);function Ht({context:t,creationReason:e,encoder:n}){let o=0;const r=t.view.id,s={start:1/0,end:-1/0,creation_reason:e,records_count:0,has_full_snapshot:!1,index_in_view:a.FT(r),source:"browser",...t};return a.ui(r),{addRecord:function(t,e){s.start=Math.min(s.start,t.timestamp),s.end=Math.max(s.end,t.timestamp),s.records_count+=1,s.has_full_snapshot||(s.has_full_snapshot=t.type===x);const r=n.isEmpty?'{"records":[':",";n.write(r+JSON.stringify(t),(t=>{o+=t,e(o)}))},flush:function(t){if(n.isEmpty)throw new Error("Empty segment flushed");n.write(`],${JSON.stringify(s).slice(1)}\n`),n.finish((e=>{a.pk(s.view.id,e.rawBytesCount),t(s,e)}))}}}const Xt=5*gt.WT;let Ft=6e4;function Wt(t,e,n,o,r,s){return function(t,e,n,o){let r={status:0,nextSegmentCreationReason:"init"};const{unsubscribe:s}=t.subscribe(2,(()=>{a("view_change")})),{unsubscribe:i}=t.subscribe(10,(t=>{a(t.reason)}));function a(t){1===r.status&&(r.segment.flush(((e,o)=>{const r=function(t,e,n){const o=new FormData;o.append("segment",new Blob([t],{type:"application/octet-stream"}),`${e.session.id}-${e.start}`);const r={raw_segment_size:n,compressed_segment_size:t.byteLength,...e},s=JSON.stringify(r);return o.append("event",new Blob([s],{type:"application/json"})),{data:o,bytesCount:t.byteLength}}(o.output,e,o.rawBytesCount);(0,Vt.PT)(t)?n.sendOnExit(r):n.send(r)})),(0,$t.gr)(r.expirationTimeoutId)),r="stop"!==t?{status:0,nextSegmentCreationReason:t}:{status:2}}return{addRecord:t=>{if(2!==r.status){if(0===r.status){const t=e();if(!t)return;r={status:1,segment:Ht({encoder:o,context:t,creationReason:r.nextSegmentCreationReason}),expirationTimeoutId:(0,$t.iK)((()=>{a("segment_duration_limit")}),Xt)}}r.segment.addRecord(t,(t=>{t>Ft&&a("segment_bytes_limit")}))}},stop:()=>{a("stop"),s(),i()}}}(t,(()=>function(t,e,n){const o=e.findTrackedSession(),r=n.findView();if(!o||!r)return;return{application:{id:t},session:{id:o.id},view:{id:r.id}}}(e.applicationId,n,o)),r,s)}function Bt(t,e,n,i,a,c){const u=[],l=c||(0,r.UF)(e.sessionReplayEndpointBuilder,Ft,(e=>{t.notify(13,{error:e}),(0,o.eJ)("Error reported to customer",{"error.message":e.message})}));let d;if((0,s.xT)())({addRecord:d}=function(t){const e=(0,s.Ad)();return{addRecord:n=>{const o=t.findView();e.send("record",n,o.id)}}}(i));else{const o=Wt(t,e,n,i,l,a);d=o.addRecord,u.push(o.stop)}const{stop:f}=At({emit:d,configuration:e,lifeCycle:t,viewHistory:i});return u.push(f),{stop:()=>{u.forEach((t=>t()))}}}}}]);